import{_ as n,a as e,b as r}from"./tslib.es6-ac47674d.js";import{miscValues as t}from"./vars.js";var o={},i=[];function a(n,e){o[n]=e}function s(n){delete o[n]}function c(n){if(i.includes(n))throw new Error("Recursive alias");return i.push(n),n in o?c(o[n]):(i=[],n)}function u(n){return new Promise((function(e){var r=new Image;r.addEventListener("load",(function(){e(r)})),r.crossOrigin="Anonymous",r.src=n}))}function l(n){return new Promise((function(e){n.canvas.toBlob((function(n){e(URL.createObjectURL(n))}))}))}function v(n,e,r,t,o,i){return new Promise((function(a){r[0]instanceof Array||(r=[r]),r=r;var s={};for(var c in r)for(var u in r[c])if(r[c][u]){if(r[c][u]=r[c][u].toString().toLowerCase(),!(r[c][u]in e))throw new Error("Invalid icon name");s[r[c][u]]=[parseInt(u),parseInt(c)]}var v=document.createElement("canvas").getContext("2d"),d=new Image;d.addEventListener("load",(function(){for(var n in v.canvas.width=o[0],v.canvas.height=o[1],s)v.drawImage(d,s[n][0]*t[0],s[n][1]*t[1],t[0],t[1],e[n][0]*t[0],e[n][1]*t[1],t[0],t[1]);var r,c=function(){l(v).then(a)};i&&(r=i(v)),r instanceof Promise?r.then(c):c()})),d.crossOrigin="Anonymous",d.src=n}))}var d={},f={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]};function m(r,t,o,i){return void 0===i&&(i=!1),n(this,void 0,void 0,(function(){var n,s,u,l;return e(this,(function(e){switch(e.label){case 0:for(s in void 0===o&&(d[r]||(d[r]=0),o=d[r]++),n={},f)n[s]=[o,f[s][1]];for(s in Game.Tiers)n[Game.Tiers[s].name.toLowerCase()]=n[s.toString()]=[o,Game.Tiers[s].iconRow];return u=a,l=[r],[4,v(i?c(r):r,n,t,[48,48],[48*(o+1),48*(Object.values(n).reduce((function(n,e){return Math.max(n,e[1])}),-1/0)+1)],(function(n){return new Promise((function(e){if(c(r)!==r){var t=new Image;t.addEventListener("load",(function(){n.drawImage(t,0,0),e()})),t.src=c(r),t.crossOrigin="Anonymous"}else e()}))}))];case 1:return u.apply(void 0,l.concat([e.sent()])),[2]}}))}))}var h={},w={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]};function g(r,t,o,i){return void 0===i&&(i=!1),n(this,void 0,void 0,(function(){var n,s,u,l;return e(this,(function(e){switch(e.label){case 0:for(s in void 0===o&&(h[r]||(h[r]=0),o=h[r]++),n={},w)n[s]=[w[s][0],o];for(s in Game.ObjectsById)n[Game.ObjectsById[s].single.toLowerCase()]=n[s]=[Game.ObjectsById[s].iconColumn,o];return u=a,l=[r],[4,v(i?c(r):r,n,t,[48,48],[48*(Object.values(n).reduce((function(n,e){return Math.max(n,e[0])}),-1/0)+1),48*(o+1)],(function(n){return new Promise((function(e){if(c(r)!==r){var t=new Image;t.addEventListener("load",(function(){n.drawImage(t,0,0),e()})),t.src=c(r),t.crossOrigin="Anonymous"}else e()}))}))];case 1:return u.apply(void 0,l.concat([e.sent()])),[2]}}))}))}function I(r,o,i){var s;return void 0===i&&(i=!0),n(this,void 0,void 0,(function(){var n,v,d,f,m,h,w,g,I,b,p,y,L,O,j;return e(this,(function(e){switch(e.label){case 0:return n=document.createElement("canvas").getContext("2d"),[4,u(i?c(r):r)];case 1:for(v=e.sent(),d=[v.width,v.height],f=0,m=o;f<m.length;f++)48*(h=m[f])[0][0]>d[0]&&(d[0]=48*h[0][0]),48*h[0][1]>d[1]&&(d[1]=48*h[0][1]);n.canvas.width=d[0],n.canvas.height=d[1],n.drawImage(v,0,0),w={},g=0,I=o,e.label=2;case 2:return g<I.length?(b=I[g],p=c((null!==(s=b[1][2])&&void 0!==s?s:t.iconLink)||"img/icons.png"),w[p]?[3,4]:(y=w,L=p,[4,u(p)])):[3,6];case 3:y[L]=e.sent(),e.label=4;case 4:n.clearRect(48*b[0][0],48*b[0][1],48,48),n.drawImage(w[p],48*b[1][0],48*b[1][1],48,48,48*b[0][0],48*b[0][1],48,48),e.label=5;case 5:return g++,[3,2];case 6:return O=a,j=[r],[4,l(n)];case 7:return O.apply(void 0,j.concat([e.sent()])),[2]}}))}))}function b(n){return void 0===(n=r([],n))[2]||null===n[2]?n[2]=c(t.iconLink):n[2]=c(n[2]),n}var p={alias:a,aliases:o,extraColumnIcons:f,extraRowIcons:w,patchIconsheet:I,relinkColumn:m,relinkRow:g,resolveAlias:c,resolveIcon:b,unalias:s};export{a as alias,o as aliases,f as extraColumnIcons,w as extraRowIcons,p as iconsNamespace,I as patchIconsheet,m as relinkColumn,g as relinkRow,c as resolveAlias,b as resolveIcon,s as unalias};
