import"./tslib.es6-ac47674d.js";import{setUnitOwner as e}from"./vars.js";import{toSentenseCase as t}from"./helpers.js";import"./lz-string.js";import{save as o,customLoad as i}from"./saves.js";import{shouldRunVersionedMinigame as n}from"./generic.js";import"./eventemitter.js";import"./buildings.js";import s from"./basegame.js";import{minigamePromises as a}from"./minigamePromises.js";var d;a.Temple.then((function(){return d=Game.Objects.Temple.minigame}));var r=[];function l(e,t){var o,i,n;if(!d)throw new Error("The pantheon minigame has not loaded yet!");var s=document.querySelector("#templeGod"+e.id);if(s){if(s.className="ready templeGod titleFont",s.style.transform="none",-1!==t){var a=d.godsById[d.slot[t]],r=document.querySelector("#templeSlot"+t);if(a){var l=document.querySelector("#templeGod"+a.id);if(!l)return;if(-1!==e.slot)null===(o=document.querySelector("#templeSlot"+e.slot))||void 0===o||o.appendChild(l);else{var m=document.querySelector("#templeGodPlaceholder"+a.id);m&&(null===(i=m.parentNode)||void 0===i||i.insertBefore(l,m))}}r&&r.appendChild(s)}else{var p=document.querySelector("#templeGodPlaceholder"+e.id);p&&(null===(n=p.parentNode)||void 0===n||n.insertBefore(s,p),p.style.display="none")}d.slotGod(e,t)}}var m=function(i,n,s,a,r,m){var p,c=this;if(this.icon=s,this.slot=-1,!d)throw new Error("The pantheon minigame has not loaded yet!");e(this),this.quote=r||void 0,this.name=m||t(i)+", Spirit of "+t(n),a&&(a[1]&&(this.desc1=a[1]),a[2]&&(this.desc2=a[2]),a[3]&&(this.desc3=a[3]),a.before&&(this.descBefore=a.before),a.after&&(this.descAfter=a.after),a.active&&(this.activeDescFunc=a.active)),this.id=d.godsById.length,d.godsById.push(this),d.gods[n]=this;var h,u,v,f=document.createElement("div");f.classList.add("ready","templeGod","templeGod"+this.id%4,"titleFont"),f.id="templeGod"+this.id,h=f,u=d.godTooltip(this.id),v="this",h.addEventListener("mouseover",(function(){Game.tooltip.dynamic="function"==typeof u?1:0,Game.tooltip.draw(h,u,v),Game.tooltip.wobble()})),h.addEventListener("mouseout",(function(){return Game.tooltip.shouldHide=1}));var g=document.createElement("div");g.classList.add("usesIcon","shadowFilter","templeIcon"),g.style.backgroundPosition=48*-s[0]+"px "+48*-s[1]+"px",s[2]&&(g.style.backgroundImage="url("+s[2]+")"),f.appendChild(g);var y=document.createElement("div");y.classList.add("templeSlotDrag"),y.id="templeGodDrag"+this.id,y.addEventListener("mousedown",(function(e){0===e.button&&d&&d.dragGod(c)})),y.addEventListener("mouseup",(function(e){0===e.button&&d&&d.dropGod()})),f.appendChild(y);var G=document.createElement("div");G.classList.add("templeGodPlaceholder"),G.id="templeGodPlaceholder"+this.id;var S=document.querySelector("#templeGods");if(S&&(S.appendChild(f),S.appendChild(G)),null===(p=o.minigames)||void 0===p?void 0:p.pantheon)for(var b in d.slotNames)o.minigames.pantheon.slots[b]===this.id&&l(this,parseInt(b))};n("Pantheon",1)&&(s.on("preSave",(function(){if(d)for(var e in o.minigames||(o.minigames={}),o.minigames.pantheon||(o.minigames.pantheon={slots:[]}),d.slotNames)-1!==d.slot[e]&&(o.minigames.pantheon.slots[e]="sync"),d.godsById[d.slot[e]]instanceof m&&(o.minigames.pantheon.slots[e]=d.slot[e],d.slot[e]=-1)})),s.on("postSave",(function(){var e;if(d&&(null===(e=o.minigames)||void 0===e?void 0:e.pantheon))for(var t in d.slotNames){var i=o.minigames.pantheon.slots[t];void 0!==i&&"sync"!==i&&(d.slot[t]=i)}})),s.on("reset",(function(){var e;(null===(e=o.minigames)||void 0===e?void 0:e.pantheon)&&(o.minigames.pantheon.slots=[])})),i.push((function(){var e;if(d&&(null===(e=o.minigames)||void 0===e?void 0:e.pantheon))for(var t in d.slotNames){var i=o.minigames.pantheon.slots[t];"sync"!==i&&d.godsById[i]instanceof m&&l(d.godsById[i],parseInt(t))}})));export{m as Spirit,r as customSpirits,l as slotGod};
