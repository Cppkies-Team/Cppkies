!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).Cppkies={})}(this,(function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(e,t)};function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function i(e,n,t,i){return new(t||(t=Promise))((function(o,a){function r(e){try{u(i.next(e))}catch(e){a(e)}}function s(e){try{u(i.throw(e))}catch(e){a(e)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,s)}u((i=i.apply(e,n||[])).next())}))}function o(e,n){var t,i,o,a,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=n.call(e,r)}catch(e){a=[6,e],i=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function a(e,n,t){if(t||2===arguments.length)for(var i,o=0,a=n.length;o<a;o++)!i&&o in n||(i||(i=Array.prototype.slice.call(n,0,o)),i[o]=n[o]);return e.concat(i||n)}var r={cookieOrder:121212,iconLink:"",buildingLink:""},s=[],u=[],c=[],d=[],m=[],p=null;function f(e){p=e}function h(e){p&&(e.owner=p,p.ownedUnits.push(e))}var v={},g=[];function y(e,n){v[e]=n}function b(e){if(g.includes(e))throw new Error("Recursive alias");return g.push(e),e in v?b(v[e]):(g=[],e)}function k(e){return new Promise((function(n){var t=new Image;t.addEventListener("load",(function(){n(t)})),t.crossOrigin="Anonymous",t.src=e}))}function _(e){return new Promise((function(n){e.canvas.toBlob((function(e){n(URL.createObjectURL(e))}))}))}function G(e,n,t,i,o,a){return new Promise((function(r){t[0]instanceof Array||(t=[t]),t=t;var s={};for(var u in t)for(var c in t[u])if(t[u][c]){if(t[u][c]=t[u][c].toString().toLowerCase(),!(t[u][c]in n))throw new Error("Invalid icon name");s[t[u][c]]=[parseInt(c),parseInt(u)]}var l=document.createElement("canvas").getContext("2d"),d=new Image;d.addEventListener("load",(function(){for(var e in l.canvas.width=o[0],l.canvas.height=o[1],s)l.drawImage(d,s[e][0]*i[0],s[e][1]*i[1],i[0],i[1],n[e][0]*i[0],n[e][1]*i[1],i[0],i[1]);var t,u=function(){_(l).then(r)};a&&(t=a(l)),t instanceof Promise?t.then(u):u()})),d.crossOrigin="Anonymous",d.src=e}))}var w={},C={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]};var S={},O={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]};function I(e){return void 0===(e=a([],e))[2]||null===e[2]?e[2]=b(r.iconLink):e[2]=b(e[2]),e}var P={alias:y,aliases:v,extraColumnIcons:C,extraRowIcons:O,patchIconsheet:function(e,n,t){var a;return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){var i,s,u,c,l,d,m,p,f,h,v,g,G,w,C;return o(this,(function(o){switch(o.label){case 0:return i=document.createElement("canvas").getContext("2d"),[4,k(t?b(e):e)];case 1:for(s=o.sent(),u=[s.width,s.height],c=0,l=n;c<l.length;c++)48*(d=l[c])[0][0]>u[0]&&(u[0]=48*d[0][0]),48*d[0][1]>u[1]&&(u[1]=48*d[0][1]);i.canvas.width=u[0],i.canvas.height=u[1],i.drawImage(s,0,0),m={},p=0,f=n,o.label=2;case 2:return p<f.length?(h=f[p],v=b((null!==(a=h[1][2])&&void 0!==a?a:r.iconLink)||"img/icons.png"),m[v]?[3,4]:(g=m,G=v,[4,k(v)])):[3,6];case 3:g[G]=o.sent(),o.label=4;case 4:i.clearRect(48*h[0][0],48*h[0][1],48,48),i.drawImage(m[v],48*h[1][0],48*h[1][1],48,48,48*h[0][0],48*h[0][1],48,48),o.label=5;case 5:return p++,[3,2];case 6:return w=y,C=[e],[4,_(i)];case 7:return w.apply(void 0,C.concat([o.sent()])),[2]}}))}))},relinkColumn:function(e,n,t,a){return void 0===a&&(a=!1),i(this,void 0,void 0,(function(){var i,r,s,u;return o(this,(function(o){switch(o.label){case 0:for(r in void 0===t&&(w[e]||(w[e]=0),t=w[e]++),i={},C)i[r]=[t,C[r][1]];for(r in Game.Tiers)i[Game.Tiers[r].name.toLowerCase()]=i[r.toString()]=[t,Game.Tiers[r].iconRow];return s=y,u=[e],[4,G(a?b(e):e,i,n,[48,48],[48*(t+1),48*(Object.values(i).reduce((function(e,n){return Math.max(e,n[1])}),-1/0)+1)],(function(n){return new Promise((function(t){if(b(e)!==e){var i=new Image;i.addEventListener("load",(function(){n.drawImage(i,0,0),t()})),i.src=b(e),i.crossOrigin="Anonymous"}else t()}))}))];case 1:return s.apply(void 0,u.concat([o.sent()])),[2]}}))}))},relinkRow:function(e,n,t,a){return void 0===a&&(a=!1),i(this,void 0,void 0,(function(){var i,r,s,u;return o(this,(function(o){switch(o.label){case 0:for(r in void 0===t&&(S[e]||(S[e]=0),t=S[e]++),i={},O)i[r]=[O[r][0],t];for(r in Game.ObjectsById)i[Game.ObjectsById[r].single.toLowerCase()]=i[r]=[Game.ObjectsById[r].iconColumn,t];return s=y,u=[e],[4,G(a?b(e):e,i,n,[48,48],[48*(Object.values(i).reduce((function(e,n){return Math.max(e,n[0])}),-1/0)+1),48*(t+1)],(function(n){return new Promise((function(t){if(b(e)!==e){var i=new Image;i.addEventListener("load",(function(){n.drawImage(i,0,0),t()})),i.src=b(e),i.crossOrigin="Anonymous"}else t()}))}))];case 1:return s.apply(void 0,u.concat([o.sent()])),[2]}}))}))},resolveAlias:b,resolveIcon:I,unalias:function(e){delete v[e]}};function L(e,n){var t=null===n[0],i=new RegExp("");null!==n[0]&&((i="string"==typeof n[0]?new RegExp(n[0].replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"):n[0]).test(e)||console.warn("Nothing to inject."));switch(n[2]){case"before":e=t?e.replace(/(\)[^{]*{)/,"$1"+n[1]):e.replace(i,""+n[1]+n[0]);break;case"replace":e=t?n[1]:e.replace(i,n[1]);break;case"after":e=t?e.replace(/(}?)$/,n[1]+"$1"):e.replace(i,""+n[0]+n[1]);break;default:throw new Error('where Parameter must be "before", "replace" or "after"')}return e}function E(e,n,t,i,o){void 0===o&&(o={});var r=Function.apply(void 0,a(a([],Object.keys(o)),["return ("+L(e.toString(),[n,t,i])+")"])).apply(void 0,Object.values(o));return r.prototype=e.prototype,r}function A(e,n,t){void 0===t&&(t={});for(var i=e.toString(),o=0,r=n;o<r.length;o++){i=L(i,r[o])}var s=Function.apply(void 0,a(a([],Object.keys(t)),["return ("+i+")"])).apply(void 0,Object.values(t));return s.prototype=e.prototype,s}function N(e,n){for(var t in n)e[t]=n[t]}function T(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function M(e,n){return e.hasOwnProperty(n)}var j=String.fromCharCode,K=function(e,n,t){if(null==e)return"";var i,o,a,r={},s={},u="",c="",l="",d=2,m=3,p=2,f=[],h=0,v=0;for(a=0;a<e.length;a+=1)if(u=e.charAt(a),Object.prototype.hasOwnProperty.call(r,u)||(r[u]=m++,s[u]=!0),c=l+u,Object.prototype.hasOwnProperty.call(r,c))l=c;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<p;i++)h<<=1,v==n-1?(v=0,f.push(t(h)),h=0):v++;for(o=l.charCodeAt(0),i=0;i<8;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1}else{for(o=1,i=0;i<p;i++)h=h<<1|o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o=0;for(o=l.charCodeAt(0),i=0;i<16;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[l]}else for(o=r[l],i=0;i<p;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1;0==--d&&(d=Math.pow(2,p),p++),r[c]=m++,l=String(u)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<p;i++)h<<=1,v==n-1?(v=0,f.push(t(h)),h=0):v++;for(o=l.charCodeAt(0),i=0;i<8;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1}else{for(o=1,i=0;i<p;i++)h=h<<1|o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o=0;for(o=l.charCodeAt(0),i=0;i<16;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[l]}else for(o=r[l],i=0;i<p;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(o=2,i=0;i<p;i++)h=h<<1|1&o,v==n-1?(v=0,f.push(t(h)),h=0):v++,o>>=1;for(;;){if(h<<=1,v==n-1){f.push(t(h));break}v++}return f.join("")},R=function(e,n,t){var i,o,a,r,s,u,c,l=[],d=4,m=4,p=3,f="",h=[],v={val:t(0),position:n,index:1};for(i=0;i<3;i+=1)l[i]=i;for(a=0,s=Math.pow(2,2),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,s=Math.pow(2,8),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;c=j(a);break;case 1:for(a=0,s=Math.pow(2,16),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;c=j(a);break;case 2:return""}for(l[3]=c,o=c,h.push(c);;){if(v.index>e)return"";for(a=0,s=Math.pow(2,p),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;switch(c=a){case 0:for(a=0,s=Math.pow(2,8),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;l[m++]=j(a),c=m-1,d--;break;case 1:for(a=0,s=Math.pow(2,16),u=1;u!=s;)r=v.val&v.position,v.position>>=1,0==v.position&&(v.position=n,v.val=t(v.index++)),a|=(r>0?1:0)*u,u<<=1;l[m++]=j(a),c=m-1,d--;break;case 2:return h.join("")}if(0==d&&(d=Math.pow(2,p),p++),l[c])f=l[c];else{if(c!==m)return null;f=o+o.charAt(0)}h.push(f),l[m++]=o+f.charAt(0),o=f,0==--d&&(d=Math.pow(2,p),p++)}},x=Game.dragonLevels.length+0,H=[];function U(e){switch(e){case"mod":return{custom:null};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!")}}function B(){return{mods:{},foreign:U("mod"),saveVer:3,dragon:U("dragon")}}var F=B();function q(){var e=B();N(F,e)}function D(e){var n,t=e.amount,i=e.bought,o=e.free,a=e.totalCookies,r=e.level,s=e.muted,u=e.minigameSave,c=e.name,l=e.owner;if(l){var d=F.mods[l.keyname].buildings;d?d[c]={amount:t,bought:i,free:o,totalCookies:a,level:r,muted:s,minigameSave:u}:F.mods[l.keyname].buildings=((n={})[c]={amount:t,bought:i,free:o,totalCookies:a,level:r,muted:s,minigameSave:u},n)}else F.foreign.buildings||(F.foreign.buildings={}),F.foreign.buildings[c]={amount:t,bought:i,free:o,totalCookies:a,level:r,muted:s,minigameSave:u}}function V(e){var n,t;return(null===(t=null===(n=e.owner?F.mods[e.owner.keyname]:F.foreign)||void 0===n?void 0:n.buildings)||void 0===t?void 0:t[e.name])||U("building")}function Y(e){var n;if(e.owner){var t=F.mods[e.owner.keyname].upgrades;t?t[e.name]={unlocked:!!e.unlocked,bought:!!e.bought}:F.mods[e.owner.keyname].upgrades=((n={})[e.name]={unlocked:!!e.unlocked,bought:!!e.bought},n)}else F.foreign.upgrades||(F.foreign.upgrades={}),F.foreign.upgrades[e.name]={unlocked:!!e.unlocked,bought:!!e.bought}}function W(e){var n,t;return(null===(t=null===(n=e.owner?F.mods[e.owner.keyname]:F.foreign)||void 0===n?void 0:n.upgrades)||void 0===t?void 0:t[e.name])||U("upgrade")}function X(e){var n;if(e.owner){var t=F.mods[e.owner.keyname].achievements;t?t[e.name]={won:!!e.won}:F.mods[e.owner.keyname].achievements=((n={})[e.name]={won:!!e.won},n)}else F.foreign.achievements||(F.foreign.achievements={}),F.foreign.achievements[e.name]={won:!!e.won}}function $(e){var n,t;return(null===(t=null===(n=e.owner?F.mods[e.owner.keyname]:F.foreign)||void 0===n?void 0:n.achievements)||void 0===t?void 0:t[e.name])||U("achievement")}function J(e){F.mods[e.keyname]?F.mods[e.keyname].custom=e.custom:F.mods[e.keyname]={custom:e.custom};for(var n=0,t=e.toggles;n<t.length;n++){var i=t[n];if(i.save){var o=F.mods[e.keyname].ui;o?o[i.keyname]=i.save():F.mods[e.keyname].ui={}}}}function z(e){return F.mods[e.keyname]||U("mod")}function Q(e,n){if(e.custom=n.custom,n.ui)for(var t=0,i=e.toggles;t<i.length;t++){var o=i[t];o.load&&M(n.ui,o.keyname)&&o.load(n.ui[o.keyname])}}function Z(e){var n;if(""===e||"{}"===e)q();else try{var t=function(e){return null==e?"":""==e?null:R(e.length,16384,(function(n){return e.charCodeAt(n)-32}))}(e);t||(t=e),n=JSON.parse(t)}catch(e){console.warn("CPPKIES: Found invalid save, creating new one..."),console.error(e),q()}var i=function(e){var n=B();if("object"!=typeof e||null===e)return n;if(!M(e,"saveVer")||"number"!=typeof e.saveVer||e.saveVer>3)return n;function t(e){var n=U("mod");if("object"!=typeof e||null===e)return n;if(M(e,"buildings")&&"object"==typeof e.buildings&&null!==e.buildings&&(e.buildings,1))for(var t in n.buildings={},e.buildings){var i=e.buildings[t];"object"==typeof i&&null!==i&&(n.buildings[t]=U("building"),N(n.buildings[t],i))}if(M(e,"upgrades")&&"object"==typeof e.upgrades&&null!==e.upgrades&&(e.upgrades,1))for(var o in n.upgrades={},e.upgrades){var a=e.upgrades[o];"object"==typeof a&&null!==a&&(n.upgrades[o]=U("upgrade"),N(n.upgrades[o],a))}if(M(e,"achievements")&&"object"==typeof e.achievements&&null!==e.achievements&&(e.achievements,1))for(var r in n.achievements={},e.achievements){var s=e.achievements[r];"object"==typeof s&&null!==s&&(n.achievements[r]=U("achievement"),N(n.achievements[r],s))}if(M(e,"ui")&&"object"==typeof e.ui&&null!==e.ui&&(e.ui,1))for(var u in n.ui={},e.ui)n.ui[u]=e.ui[u];return M(e,"custom")&&"object"==typeof e.custom&&(n.custom=e.custom),n}if(M(e,"foreign")?n.foreign=t(e.foreign):n.foreign=U("mod"),M(e,"mods")&&"object"==typeof e.mods&&null!==e.mods&&(e.mods,1))for(var i in e.mods)n.mods[i]=t(e.mods[i]);if(M(e,"dragon")&&"object"==typeof e.dragon&&null!==e.dragon&&(!M(e.dragon,"level")||"number"!=typeof e.dragon.level&&"sync"!==e.dragon.level||(n.dragon.level=e.dragon.level),M(e.dragon,"auras")&&e.dragon.auras instanceof Array))for(var o in e.dragon.auras){var a=e.dragon.auras[o];"number"!=typeof a&&"sync"!==a||(n.dragon.auras[o]=a)}if(M(e,"minigames")&&"object"==typeof e.minigames&&null!==e.minigames&&(e.minigames,1))for(var r in n.minigames={},e.minigames){var s=e.minigames[r];"object"==typeof s&&null!==s&&(n.minigames[r]=s)}return n}(n);N(F,i),function(){for(var e=0,n=s;e<n.length;e++){var t=n[e];N(t,V(t))}for(var i=0,o=c;i<o.length;i++){var a=o[i];N(a,W(a)),a.bought&&Game.CountsAsUpgradeOwned(a.pool)&&Game.UpgradesOwned++}for(var r=0,l=u;r<l.length;r++){var d=l[r];N(d,$(d)),d.won&&Game.CountsAsAchievementOwned(d.pool)&&Game.AchievementsOwned++}for(var p=0,f=m;p<f.length;p++){var h=f[p];Q(h,z(h))}for(var v=0,g=H;v<g.length;v++)(0,g[v])()}()}function ee(){return function(){for(var e=0,n=m;e<n.length;e++)J(n[e]);for(var t=0,i=s;t<i.length;t++)D(i[t]);for(var o=0,a=c;o<a.length;o++)Y(a[o]);for(var r=0,l=u;r<l.length;r++)X(l[r])}(),null==(e=JSON.stringify(F))?"":K(e,15,(function(e){return j(e+32)}))+" ";var e}function ne(e){return"fortune"===e.tier}var te,ie=function(e){function n(n,t,i,o,a){void 0===a&&(a=function(){});var r=e.call(this,n,"function"==typeof t?"":t,"function"==typeof i?0:i,"function"==typeof o?[0,0]:I(o),a)||this;return h(r),"function"==typeof t&&(r.descFunc=t),"function"==typeof i&&(r.priceFunc=i),"function"==typeof o&&(r.iconFunction=function(){return I(o())}),c.push(r),N(r,W(r)),Game.upgradesToRebuild=1,r.bought&&Game.CountsAsUpgradeOwned(r.pool)&&Game.UpgradesOwned++,r}return t(n,e),n}(Game.Upgrade),oe=function(e){function n(n,t,i,o,a,r,s){void 0===r&&(r=["Legacy"]),void 0===s&&(s=function(){});var u=e.call(this,n,t,i,o,s)||this;return u.pool="prestige",u.posX=a[0],u.posY=a[1],u.parents=r.map((function(e){return"number"==typeof e?Game.UpgradesById[e]:Game.Upgrades[e]})),Game.PrestigeUpgrades.push(u),Game.UpgradePositions[u.id]=a,u}return t(n,e),n}(ie),ae=function(e){function n(n,t,i,o){var a=this;return"string"==typeof i&&(i=Game.Objects[i]),(a=e.call(this,n,T(i.plural)+" are <b>twice</b> as efficient.<q>"+t+"</q>",i.basePrice*Game.Tiers[o].price,Game.GetIcon(i.name,o))||this).pool="",a.tier=o,a.buildingTie=i,i.tieredUpgrades[o]=a,a.buildingTie1=i,ne(a)&&(a.order=19e3,i.fortune=a,Game.Tiers[o].upgrades.push(a)),isNaN(parseInt(o.toString()))||(o=parseInt(o.toString())),"number"==typeof o&&(a.order=100*(i.id+1)+a.id/1e3,a.order-=75*Math.max(0,Math.min(i.id-4,3)),i.id>=8&&(a.order-=75)),i.buyFunction.apply(i),a}return t(n,e),n}(ie),re=function(){function e(){this._events={}}return e.prototype.on=function(e,n){if(this.forwardTo)return this.forwardTo.on(e,n);this._events[e]?this._events[e].push(n):this._events[e]=[n]},e.prototype.once=function(e,n){var t=this;this.on(e,(function(i){return t.off(e,n),n(i)}))},e.prototype.off=function(e,n){if(this.forwardTo)return this.forwardTo.off(e,n);this._events[e].splice(this._events[e].indexOf(n),1)},e.prototype.emit=function(e){for(var n,t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(this.forwardTo)return(n=this.forwardTo).emit.apply(n,a([e],t));var o=t[0];this._events[e]||(this._events[e]=[]);for(var r=0,s=this._events[e];r<s.length;r++){var u=s[r];o=u(o)}return o},e.prototype.constEmit=function(e){for(var n,t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(this.forwardTo)return(n=this.forwardTo).constEmit.apply(n,a([e],t));this._events[e]||(this._events[e]=[]);for(var o=0,r=this._events[e];o<r.length;o++){var s=r[o];s(t[0])}},e.prototype.setForwardTarget=function(e){var n;for(var t in this._events)e._events[t]?(n=e._events[t]).push.apply(n,this._events[t]):e._events[t]=Array.from(this._events[t]);this.forwardTo=e},e}(),se=function(){function e(e,n,t){this.value=e,this.hookVersion=n,this.func=t}return e.prototype.runHook=function(){var e;ue(this.hookVersion)&&(null===(e=this.func)||void 0===e||e.call(this))},e}();function ue(e){return!window.__INTERNAL_CPPKIES_HOOKS__||e>window.__INTERNAL_CPPKIES_HOOKS__.hooksVersion}function ce(e){te=e}var le=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.runHook=function(){var e;te&&de(te,this.hookVersion)&&(null===(e=this.func)||void 0===e||e.call(this))},n}(se);function de(e,n){return!window.__INTERNAL_CPPKIES_HOOKS__||!window.__INTERNAL_CPPKIES_HOOKS__.injectedMinigames.has("object"==typeof e?e.name:e)||n>window.__INTERNAL_CPPKIES_HOOKS__.hooksVersion}var me=window.__INTERNAL_CPPKIES_HOOKS__?window.__INTERNAL_CPPKIES_HOOKS__.buildings:{};function pe(e){var n=new re;[new se("tooltip",1,(function(){e.tooltip=E(E(e.tooltip,"return","let tempRet = ","replace"),null,'\n//Cppkies injection\n\t\t\t\treturn __INTERNAL_CPPKIES_HOOKS__.buildings[this.name].emit("tooltip", tempRet)',"after")})),new se("buy",1,(function(){e.buy=E(e.buy,null,'\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.buildings[this.name].emit("buy")\n\t\t\t\t}',"after")})),new se("levelUp",1,(function(){e.levelUp=E(e.levelUp,"me.level+=1;",'\n// Cppkies injection\n__INTERNAL_CPPKIES_HOOKS__.buildings[me.name].emit("levelUp")',"after",{me:e})}))].forEach((function(e){return e.runHook()})),me[e.name]=n}var fe=new re;var he=function(e){function n(n,t,i,o){var r=this;if(o){if(!o.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+o+'", URL must end with .png');o=o.substring(0,o.length-4)}"string"==typeof i&&(i=Game.Objects[i]);var s=i.id-1;return 1===s?s="grandma":s+=" grandmas",(r=e.call(this,n,"Grandmas are <b>twice</b> as efficient. "+T(i.plural)+" gain <b>+1% CpS</b> per "+s+".<q>"+t+"</q>",i.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this).pool="",i.grandma=r,r.buildingTie=i,r.order=250+r.id/1e3,i.id>=12&&(r.order+=5),Game.GrandmaSynergies.push(r.name),o&&fe.on("grandmaPic",(function(e){return r.bought?a(a([],e),[o]):e})),Game.Objects.Grandma.redraw(),i.buyFunction.apply(i),r}return t(n,e),n}(ie),ve=function(e){function n(n,t,i,o,a){var r=this;"string"==typeof i&&(i=Game.Objects[i]),"string"==typeof o&&(o=Game.Objects[o]);var s=Game.GetIcon(i.name,a);if(i.basePrice>o.basePrice){var u=i;i=o,o=u}return(r=e.call(this,n,T(i.plural)+" gain <b>+5% CpS</b> per "+o.name.toLowerCase()+".<br>"+T(o.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+i.name.toLowerCase()+".<q>"+t+"</q>",(10*i.basePrice+1*o.basePrice)*Game.Tiers[a].price,s)||this).pool="",r.tier=a,r.buildingTie1=i,r.buildingTie2=o,r.order=5e3+r.id/1e3,i.synergies.push(r),o.synergies.push(r),Game.Tiers[a].upgrades.push(r),i.buyFunction.apply(i),r}return t(n,e),n}(ie),ge=[5,7,8,9,10],ye=function(e){function n(n,t,i,o){void 0===o&&(o=20);var a=this,r=Game.Objects.Cursor,s=parseInt(i.toString());return(a=e.call(this,n,"Multiplies the gain from Thousand fingers by <b>"+o+"</b>.<q>"+t+"</q>",Game.Tiers[i].special||isNaN(s)?r.basePrice*Game.Tiers[i].price:Math.pow(10,ge[Math.min(s-4,ge.length-1)]+3*Math.max(s-8,0)),Game.GetIcon(r.name,i))||this).tier=i,a.pool="",a.order=100+a.id/1e3,fe.on("cursorFingerMult",(function(e){return a.bought?e*o:e})),Game.Tiers[i].special||isNaN(s)||me.Cursor.on("buy",(function(){r.amount>=(4===s?25:50*(s-4))&&Game.Unlock(a.name)})),"fortune"===i&&Game.Tiers[i].upgrades.push(a),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),a}return t(n,e),n}(ie),be={1:5,2:4,4:4,default:3};var ke=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],_e=function(e){function n(n,t,i,o,a,r){void 0===o&&(o=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:ke[(parseInt(i.toString())-1)%(ke.length-1)]),void 0===r&&(r=Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null:1===i?.5:i-1);var s=e.call(this,n,"You gain <b>more CpS</b> the more milk you have.<q>"+t+"</q>",Game.Tiers[i].special||isNaN(parseInt(i.toString()))?null!=a?a:0:function(e){for(var n=1,t=1;t<=e;t++)n+=t in be?be[t]:be.default;return 9*Math.pow(10,n)}(i),Game.GetIcon("Kitten",i))||this;return s.tier=i,s.kitten=!0,s.pool="",null===o&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[i].special||isNaN(parseInt(i.toString())))&&void 0===a&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==r&&fe.on("logic",(function(){Game.milkProgress>=r&&Game.Unlock(s.name)})),s.order=2e4+s.id/1e3,null!==o&&fe.on("rawCpsMult",(function(e){var n=s.bought?1+Game.milkProgress*o*window.__INTERNAL_CPPKIES_HOOKS__.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=n,e*n})),Game.UpgradesByPool.kitten.push(s),"fortune"===i&&Game.Tiers[i].upgrades.push(s),s}return t(n,e),n}(ie),Ge=function(e){function n(n,t,i,o){void 0===o&&(o=1);var a=e.call(this,n,"Clicking gains <b>+"+o+"% of your CpS</b>.<q>"+t+"</q>",Math.pow(10,3+2*parseInt(i.toString())),Game.GetIcon("Mouse",i))||this;a.tier=i,a.pool="";var r=parseInt(i.toString());return a.order=150+a.id/1e3,fe.on("cpcAdd",(function(e){return a.bought?e+Game.cookiesPs*o/100:e})),Game.Tiers[i].special||isNaN(r)||fe.on("check",(function(){Game.handmadeCookies>=Math.pow(10,1+2*r)&&Game.Unlock(a.name)})),"fortune"===i&&Game.Tiers[i].upgrades.push(a),a}return t(n,e),n}(ie),we=function(e){function n(n,t,i,o,a,s,u){var c,l=e.call(this,n,"Cookie production multiplier <b>+"+("function"==typeof a?"???":Beautify(a,1))+"%</b>.<q>"+t+"</q>",i,o)||this;return l.power=a,l.pool="cookie","function"==typeof a&&(l.baseDesc="Cookie production multiplier <b>+"+Beautify(a(l),1)+"%</b>.<q>"+t+"</q>",l.desc=BeautifyInText(l.baseDesc)),l.order=(null!==(c=null!=u?u:r.cookieOrder)&&void 0!==c?c:10020)+l.id/1e3,l.unlockAt={name:n,cookies:("function"==typeof i?i():i)/20,require:null==s?void 0:s.require,season:null==s?void 0:s.season},Game.UnlockAt.push(l.unlockAt),Game.UpgradesByPool.cookie.push(l),Game.cookieUpgrades.push(l),l}return t(n,e),n}(ie),Ce=function(e){function n(n,t,i){var o=e.call(this,n,t,I(i))||this;return h(o),N(o,$(o)),u.push(o),o.won&&Game.CountsAsAchievementOwned(o.pool)&&Game.AchievementsOwned++,o}return t(n,e),n}(Game.Achievement),Se=function(e){function n(n,t,i,o){var a=this,r="object"==typeof i?i:Game.Objects[i],s=null,u=-1;if(0===r.id){switch(o){case"cursor2":s=[0,6],u=2;break;case"cursor50":s=[1,6],u=50;break;default:if(Game.Tiers[o].achievUnlock<=0){console.warn("Tier has invalid unlock amount");break}u=1===o?1:2*Game.Tiers[o].achievUnlock}me.Cursor.on("buy",(function(){Game.Objects.Cursor.amount>=u&&Game.Win(a.name)}))}else u=Game.Tiers[o].achievUnlock;return(a=e.call(this,n,"Have <b>"+u+"</b> "+(1===Math.abs(u)?r.single:r.plural)+"."+(t?"<q>"+t+"</q>":""),null!=s?s:Game.GetIcon(r.name,o))||this).pool="normal",a.tier="cursor2"===o||"cursor50"===o?1:o,a.buildingTie=r,r.tieredAchievs[o]=a,a.buildingTie=r,a.order=1e3+100*r.id+a.id/1e3,a.order-=75*Math.max(0,Math.min(r.id-4,3)),r.id>=8&&(a.order-=75),0===r.id&&(a.order+=50),a}return t(n,e),n}(Ce),Oe=function(e){function n(n,t,i,o){void 0===o&&(o=Math.pow(10,Math.floor(1.5*Game.BankAchievements.length+2)));var a=e.call(this,n,"Bake <b>"+toFixed(o)+"</b> cookie"+(1===Math.abs(o)?"":"s")+" in one ascension."+(i?"<q>"+i+"</q>":""),t)||this;return a.treshold=o,a.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(a),a}return t(n,e),n}(Ce),Ie=function(e){function n(n,t,i,o){void 0===o&&(o=Math.pow(10,Math.floor(1.2*Game.BankAchievements.length)));var a=e.call(this,n,"Bake <b>"+toFixed(o)+"</b> cookie"+(1===Math.abs(o)?"":"s")+" per second."+(i?"<q>"+i+"</q>":""),t)||this;return a.treshold=o,a.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(a),a}return t(n,e),n}(Ce),Pe=function(e){function n(n,t,i){var o=this;"string"==typeof t&&(t=Game.Objects[t]);var a=[t.iconColumn,26,M(t,"iconLink")&&"string"==typeof t.iconLink?t.iconLink:void 0];return(o=e.call(this,n,"Reach level <b>10</b> "+t.plural+"."+(i?"<q>"+i+"</q>":""),a)||this).order=1020+100*t.id+o.id/1e3,o.order-=75*Math.max(0,Math.min(t.id-4,3)),t.id>=8&&(o.order-=75),0===t.id&&(o.order+=50),t.levelAchiev10=o,o}return t(n,e),n}(Ce),Le=function(e){function n(n,t,i){var o=this,a=parseInt(t.toString());return(o=e.call(this,n,"Make <b>"+toFixed(Math.pow(10,1+2*a))+"</b> cookies from clicking."+(i?"<q>"+i+"</q>":""),Game.GetIcon("Mouse",t))||this).pool="normal",o.tier=t,o.order=1e3+o.id/1e3,Game.Tiers[t].special||isNaN(a)||fe.on("check",(function(){Game.handmadeCookies>=Math.pow(10,1+2*a)&&Game.Win(o.name)})),o}return t(n,e),n}(Ce),Ee=function(e){function n(n,t,i,o,a){var r=this;"string"==typeof t&&(t=Game.Objects[t]);var s=[t.iconColumn,21+i,M(t,"iconLink")&&"string"==typeof t.iconLink?t.iconLink:void 0],u=Math.pow(10,12+t.id+(null!=a?a:0)+7*(i-1));return(r=e.call(this,n,"Make <b>"+toFixed(u)+"</b> cookies just from "+t.plural+"."+(o?"<q>"+o+"</q>":""),s)||this).order=1020+100*t.id+r.id/1e3,r.order-=75*Math.max(0,Math.min(t.id-4,3)),t.id>=8&&(r.order-=75),0===t.id&&(r.order+=50),t.productionAchievs.push({pow:u,achiev:r}),r}return t(n,e),n}(Ce),Ae=function(e){function n(n,t,i,o,a,u,c,d,m,p){var f,v,g=this;if(Game.Objects[n])throw new Error("Can't create building, \""+n+'" is already used as a building name');0!==o[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==a[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),h(g=e.call(this,n,t,i,a[1],o[0],u,0,c,d)||this),s.push(g),me[n]||pe(g);var y=function(e){if(parseInt(e)<=0)return"continue";var n=Game.ObjectsById[e];if(n.canvas=l("rowCanvas"+e),!n.canvas)return"continue";if(n.ctx=n.canvas.getContext("2d"),n.canvas.addEventListener("mouseover",(function(){n.mouseOn=!0})),n.canvas.addEventListener("mouseout",(function(){n.mouseOn=!1})),n.canvas.addEventListener("mousemove",(function(e){var t=n.canvas.getBoundingClientRect();n.mousePos[0]=e.pageX-t.left,n.mousePos[1]=e.pageY-t.top})),n.minigame&&n.minigameLoaded){var t=n.minigame.save();n.minigame.launch(),n.minigame.load(t)}};for(var k in Game.ObjectsById)y(k);g.buildingLink=null!==(f=a[2])&&void 0!==f?f:r.buildingLink,g.iconLink=b(null!==(v=o[2])&&void 0!==v?v:r.iconLink),m&&(Game.foolObjects[n]=m),p&&(Game.goldenCookieBuildingBuffs[n]=p),g.iconLink&&me[g.name].on("tooltip",(function(e){return g.locked?e:e.replace("background-position","background-image:url("+g.iconLink+");background-position")})),Game.BuildStore(),g.buildingLink&&fe.on("buildStore",(function(){var e=document.getElementById("productIcon"+g.id),n=document.getElementById("productIconOff"+g.id);e&&n&&(e.style.backgroundImage="url("+g.buildingLink+")",n.style.backgroundImage="url("+g.buildingLink+")")})),Game.BuildStore(),g.canvas=l("rowCanvas"+g.id),g.ctx=g.canvas.getContext("2d"),g.pics=[];var _=document.createElement("div");_.className="tinyProductIcon",_.id="mutedProduct"+g.id,_.style.display="none",g.buildingLink&&(_.style.backgroundImage="url("+g.buildingLink+")"),_.style.backgroundPositionX="-"+o[0]+"px",_.style.backgroundPositionY="-"+o[1]+"px",_.addEventListener("click",(function(){g.mute(0),window.PlaySound(g.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")})),window.AddEvent(g.canvas,"mouseover",(function(){g.mouseOn=!0})),window.AddEvent(g.canvas,"mouseout",(function(){g.mouseOn=!1})),g.canvas.addEventListener("mousemove",(function(e){var n=g.canvas.getBoundingClientRect();g.mousePos[0]=e.pageX-n.left,g.mousePos[1]=e.pageY-n.top}));var G=document.getElementById("buildingsMute");G&&G.appendChild(_);var w=V(g);for(var k in w)g[k]=w[k];return Game.recalculateGains=1,g}return t(n,e),n}(Game.Object);ue(1)&&fe.on("getIcon",(function(e){var n=e.icon,t=e.type,i=e.tier;return s.forEach((function(e){e.name===t&&e.iconLink&&(n[2]=e.iconLink)})),{icon:n,tier:i,type:t}}));var Ne=function(e,n,t){this.name=e,this.desc=n,this.isCppkies=!0,h(this),"string"==typeof t&&(t=Game.Objects[t]),t instanceof Game.Object?this.pic=I([t.iconColumn,25,M(t,"iconLink")&&"string"==typeof t.iconLink?t.iconLink:void 0]):this.pic=t,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==F.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=F.dragon.auras[0]&&(Game.dragonAura=F.dragon.auras[0]),"sync"!==F.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=F.dragon.auras[1]&&(Game.dragonAura2=F.dragon.auras[1])},Te=function e(n,t,i,o,a,r,s){void 0===s&&(s=Game.dragonLevels.length-3),this.buy=a,this.isCppkies=!0,this.picY=0,h(this);var u=Game.dragonLevels[s-1];this.name=null!=n?n:u.name,this.action=t,this.costStr="string"==typeof i?function(){return i}:i,this.cost=o,r?(this.pic=r[0],this.picY=r[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=r[2]):(this.pic=u.pic,u instanceof e&&(this.picY=u.picY,this.picLink=u.picLink)),Game.dragonLevels.splice(s,0,this),"sync"!==F.dragon.level&&Game.dragonLevels.length>=F.dragon.level&&(Game.dragonLevel=F.dragon.level)},Me=function(e){function n(n,t,i){var o="string"==typeof i?Game.Objects[i]:i;return e.call(this,null,"Train "+n+"<br/><small>Aura : "+t+"</small>","100 "+o.plural,(function(){return o.amount>=100}),(function(){return o.sacrifice(100)}))||this}return t(n,e),n}(Te);ue(1)&&(fe.on("preSave",(function(){if(0!==Game.dragonAura&&(F.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(F.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof Ne&&(F.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof Ne&&(F.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=x)for(F.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Te||Game.dragonLevel>=x;)Game.dragonLevel--})),fe.on("postSave",(function(){"sync"!==F.dragon.auras[0]&&Game.dragonAuras[F.dragon.auras[0]]&&(Game.dragonAura=F.dragon.auras[0]),"sync"!==F.dragon.auras[1]&&Game.dragonAuras[F.dragon.auras[1]]&&(Game.dragonAura2=F.dragon.auras[1]),"sync"!==F.dragon.level&&Game.dragonLevels[F.dragon.level]&&(Game.dragonLevel=F.dragon.level)})),fe.on("reset",(function(){F.dragon.auras=["sync","sync"],F.dragon.level="sync"})),fe.on("specialPic",(function(e){var n,t=Game.dragonLevels[Game.dragonLevel];return"dragon"===e.tab&&t instanceof Te&&(e.pic=null!==(n=t.picLink)&&void 0!==n?n:e.pic),e})),H.push((function(){"sync"!==F.dragon.level&&F.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=F.dragon.level),"sync"!==F.dragon.auras[0]&&F.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=F.dragon.auras[0]),"sync"!==F.dragon.auras[1]&&F.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=F.dragon.auras[1])})));var je=function(e,n,t,i){if(void 0===i&&(i=!1),this.name=e,this.pic=t,this.special=i,h(this),!t.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+t+'", the URL must end with .png!');i||(this.name="Rank "+function(e){for(var n="",t=0,i=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];t<i.length;t++)for(var o=i[t];e>=o[0];)n+=o[1],e-=o[0];return n}(Game.Milks.length+1)+" - "+e),this.pic=t.substr(0,t.length-4),I(n),this.icon=[n[0],n[1]],this.iconLink=n[2],i?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)},Ke=function(e,n,t,i,o,a,s,u,c){var l;void 0===i&&(i=!1),void 0===o&&(o="auto"),void 0===a&&(a=null),void 0===s&&(s=null),void 0===u&&(u=null),void 0===c&&(c="auto"),this.name=e,this.color=t,this.achievUnlock=0,this.upgrades=[],this.unlock=0,this.special=i,h(this),this.keyName="auto"===c?i?e:(Object.keys(Game.Tiers).filter((function(e){return!isNaN(parseInt(e))})).length+1).toString():c,null===a&&(this.unlock=-1),"number"==typeof a&&(this.unlock=a),(!1===i&&null===a||"auto"===a)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof s&&(this.achievUnlock=s),(!1===i&&null===s||"auto"===s)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),u&&(this.req=u),this.price="auto"===o?1e8*Game.Tiers[Object.keys(Game.Tiers).filter((function(e){return!isNaN(parseInt(e))})).length.toString()].price:o,this.iconRow=n[1],this.iconLink=b(null!==(l=n[2])&&void 0!==l?l:r.iconLink),Game.Tiers[this.keyName]=this,d.push(this)};fe.on("getIcon",(function(e){var n=e.icon,t=e.type,i=e.tier;return d.forEach((function(e){e.keyName===i.toString()&&e.iconLink&&(n[2]=e.iconLink)})),{icon:n,type:t,tier:i}})),fe.on("getIcon",(function(e){var n=e.icon,t=e.type,i=e.tier;return(void 0===n[2]||null===n[2])&&Game.Tiers[i.toString()]instanceof Ke&&(n[2]=""),{icon:n,tier:i,type:t}}));var Re=!1;function xe(){Re=!0}var He=new Proxy([],{set:function(e,n,t){return"function"==typeof t&&Re?t():e[n]=t,!0}}),Ue=new Promise((function(n){return e.defferResolve=n})),Be=function(){function e(e,n){var t=this;this.modFunction=n,this.keyname="never-should-happen",this.version="1.0",this.custom=null,this.toggles=[],this.ownedUnits=[],N(this,e);var i=m.find((function(n){return n.keyname===e.keyname}));if(i){if(i.version!==this.version)throw new Error("You are trying to load multiple versions of the same mod");console.warn("Loading the same mod ("+i.keyname+") multiple times.")}else m.push(this),Q(this,z(this)),Ue.then((function(){f(t),null==n||n.apply(t),Game.UpdateMenu(),f(null)}))}return e.prototype.render=function(){for(var e=document.createElement("div"),n=0,t=this.toggles;n<t.length;n++){var i=t[n];e.appendChild(i.render())}return e},e}();function Fe(e,n,t){if(void 0===t&&(t="div"),"string"==typeof(e=function(e){return e instanceof Function?e():e}(e)))if(t){var i=document.createElement(t);i.innerHTML=e,n.appendChild(i)}else n.innerHTML=e;else n.appendChild(e)}function qe(e,n,t,i,o,a){var r,s=document.createElement("a");s.classList.add("option"),i&&"normal"!==i&&s.classList.add(i),o&&s.classList.add("off"),a&&(r=s.classList).add.apply(r,a),Fe(e,s),s.addEventListener("click",(function(){PlaySound("snd/tick.mp3"),null==t||t()}));var u=document.createElement("div");if(u.appendChild(s),n){var c=document.createElement("label");Fe(n,c,"span"),u.appendChild(c)}return u}var De={};function Ve(e,n,t,i){var o=document.createElement("div");o.className="title",void 0===De[e]&&(De[e]=!0);var a=document.createElement("span");a.style.cursor="pointer",a.style.display="inline-block",a.style.height=a.style.width="14px",a.style.borderRadius="7px",a.style.textAlign="center",a.style.backgroundColor="#C0C0C0",a.style.color="black",a.style.fontSize="13px",a.style.verticalAlign="middle",a.style.marginRight="13px",a.textContent=De[e]?"-":"+",a.addEventListener("click",(function(){De[e]=!De[e],null==i||i()})),o.appendChild(a),Fe(n,o,"span");var r=document.createElement("div");return r.appendChild(o),De[e]&&Fe(t,r),r}var Ye=document.createElement("style");function We(e,n,t,i,o){var a,r=document.createElement("div");r.classList.add("sliderBox","cppkiesSliderBox"),Fe(e,r);var s=document.createElement("div");s.classList.add("cppkiesSliderRight"),Fe(n(t),s,null),r.appendChild(s);var u=document.createElement("input");return u.classList.add("slider"),u.type="range",u.min=i[0].toString(),u.max=i[1].toString(),u.step=(null!==(a=i[2])&&void 0!==a?a:1).toString(),u.value=t.toString(),u.addEventListener("input",(function(){s.innerText="",Fe(n(parseFloat(u.value)),s,null),null==o||o(parseFloat(u.value))})),u.addEventListener("mouseup",(function(){return PlaySound("snd/tick.mp3")})),r.appendChild(u),r}Ye.textContent="\n.cppkiesSliderBox {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.cppkiesSliderRight {\n\tposition: absolute;\n\talign-self: flex-end;\n} \n",document.head.appendChild(Ye);var Xe=function(e){var n,t;if(this.keyname=e,!p)throw new Error("You are instancing a mod UI class outside of a mod declaration.");p.toggles.push(this),this.mod=p,this.load&&void 0!==(null===(t=null===(n=F.mods[this.mod.keyname])||void 0===n?void 0:n.ui)||void 0===t?void 0:t[this.keyname])&&this.load(F.mods[this.mod.keyname].ui[this.keyname])};ue(1)&&fe.on("optionsMenu",(function(){var e,n=document.querySelector("#menu");if(n&&0!==m.length)for(var t=n.children[n.children.length-1],i=t.children[t.children.length-2],o=0,a=m;o<a.length;o++){var r=a[o];i.appendChild(Ve(r.keyname+"ui",null!==(e=r.name)&&void 0!==e?e:r.keyname,r.render(),Game.UpdateMenu))}}));var $e=function(e){function n(n,t,i,o,a){var r=e.call(this,n)||this;return r.name=t,r.description=i,r.onClick=o,r.type=a,r.additionalClasses=[],r}return t(n,e),n.prototype.render=function(){var e=this;return qe(this.name,this.description,(function(){var n;null===(n=e.onClick)||void 0===n||n.call(e),Game.UpdateMenu()}),this.type,this.off,this.additionalClasses)},n}(Xe),Je=function(e){function n(n,t,i,o,a,r){var s=e.call(this,n,"function"==typeof t?"TEMP":t,o,(function(){var e;s.state=null!==(e=s.states[s.states.indexOf(s.state)+1])&&void 0!==e?e:s.states[0],null==a||a.apply(s)}))||this;return s.states=i,s.description=o,s.type=r,void 0===s.state&&(s.state=s.states[0]),s}return t(n,e),n.prototype.save=function(){return this.state},n.prototype.load=function(e){this.state=e},n.prototype.render=function(){return this.stateFunc&&(this.name=this.stateFunc(this.state)),e.prototype.render.call(this)},n}($e),ze=function(e){function n(n,t,i,o,a,r){void 0===a&&(a=i[0]);var s=e.call(this,n)||this;return s.name=t,s.bounds=i,s.valueFunc=o,s.onChange=r,void 0===s.value&&(s.value=a),s}return t(n,e),n.prototype.save=function(){return this.value},n.prototype.load=function(e){this.value=e},n.prototype.render=function(){var e=this;return We(this.name,this.valueFunc,this.value,this.bounds,(function(n){var t;e.value=n,null===(t=e.onChange)||void 0===t||t.call(e,n)}))},n}(Xe),Qe=function(e){function n(n,t,i,o,a,r){var s=e.call(this,n,"function"==typeof t?function(e){return t("ON"===e)}:function(){return t+" "+s.state},["ON","OFF"],i,(function(){"ON"===s.state?s.additionalClasses.splice(s.additionalClasses.indexOf("off"),1):s.additionalClasses.push("off"),null==o||o.apply(s)}))||this;return s.description=i,s.type=a,s.defaultState=r,void 0===s.state&&(s.state=s.defaultState||void 0===s.defaultState?"ON":"OFF"),"OFF"===s.state&&s.additionalClasses.push("off"),s}return t(n,e),n.prototype.render=function(){return this.off="OFF"===this.state,e.prototype.render.call(this)},n}(Je),Ze={};window.__CPPKIES_MINIGAME_PROMISES_MARK__=function(e){Ze[e]&&(Ze[e](),delete Ze[e])},Game.LoadMinigames=E(Game.LoadMinigames,"document.head.appendChild(script);","\n__CPPKIES_MINIGAME_PROMISES_MARK__(me.name);","after");var en,nn=new Proxy({},{get:function(e,n){if("symbol"==typeof n)throw new Error("No such building as [symbol]!");if(e[n])return e[n];var t=Game.Objects[n];if(!t)throw new Error("No such building as "+n+"!");if(t.minigameLoaded)return e[n]=Promise.resolve();var i=document.querySelector("#minigameScript-"+t.id);return e[n]=new Promise(i?function(e,n){i.addEventListener("load",(function(){return e()})),i.addEventListener("error",n)}:function(e,i){Ze[n]=function(){var n=document.querySelector("#minigameScript-"+t.id);n&&(n.addEventListener("load",(function(){return e()})),n.addEventListener("error",i))}}),e[n]}});nn.Temple.then((function(){return en=Game.Objects.Temple.minigame}));function tn(e,n){var t,i,o;if(!en)throw new Error("The pantheon minigame has not loaded yet!");var a=document.querySelector("#templeGod"+e.id);if(a){if(a.className="ready templeGod titleFont",a.style.transform="none",-1!==n){var r=en.godsById[en.slot[n]],s=document.querySelector("#templeSlot"+n);if(r){var u=document.querySelector("#templeGod"+r.id);if(!u)return;if(-1!==e.slot)null===(t=document.querySelector("#templeSlot"+e.slot))||void 0===t||t.appendChild(u);else{var c=document.querySelector("#templeGodPlaceholder"+r.id);c&&(null===(i=c.parentNode)||void 0===i||i.insertBefore(u,c))}}s&&s.appendChild(a)}else{var l=document.querySelector("#templeGodPlaceholder"+e.id);l&&(null===(o=l.parentNode)||void 0===o||o.insertBefore(a,l),l.style.display="none")}en.slotGod(e,n)}}var on=function(e,n,t,i,o,a){var r,s=this;if(this.icon=t,this.slot=-1,!en)throw new Error("The pantheon minigame has not loaded yet!");h(this),this.quote=o||void 0,this.name=a||T(e)+", Spirit of "+T(n),i&&(i[1]&&(this.desc1=i[1]),i[2]&&(this.desc2=i[2]),i[3]&&(this.desc3=i[3]),i.before&&(this.descBefore=i.before),i.after&&(this.descAfter=i.after),i.active&&(this.activeDescFunc=i.active)),this.id=en.godsById.length,en.godsById.push(this),en.gods[n]=this;var u,c,l,d=document.createElement("div");d.classList.add("ready","templeGod","templeGod"+this.id%4,"titleFont"),d.id="templeGod"+this.id,u=d,c=en.godTooltip(this.id),l="this",u.addEventListener("mouseover",(function(){Game.tooltip.dynamic="function"==typeof c?1:0,Game.tooltip.draw(u,c,l),Game.tooltip.wobble()})),u.addEventListener("mouseout",(function(){return Game.tooltip.shouldHide=1}));var m=document.createElement("div");m.classList.add("usesIcon","shadowFilter","templeIcon"),m.style.backgroundPosition=48*-t[0]+"px "+48*-t[1]+"px",t[2]&&(m.style.backgroundImage="url("+t[2]+")"),d.appendChild(m);var p=document.createElement("div");p.classList.add("templeSlotDrag"),p.id="templeGodDrag"+this.id,p.addEventListener("mousedown",(function(e){0===e.button&&en&&en.dragGod(s)})),p.addEventListener("mouseup",(function(e){0===e.button&&en&&en.dropGod()})),d.appendChild(p);var f=document.createElement("div");f.classList.add("templeGodPlaceholder"),f.id="templeGodPlaceholder"+this.id;var v=document.querySelector("#templeGods");if(v&&(v.appendChild(d),v.appendChild(f)),null===(r=F.minigames)||void 0===r?void 0:r.pantheon)for(var g in en.slotNames)F.minigames.pantheon.slots[g]===this.id&&tn(this,parseInt(g))};de("Pantheon",1)&&(fe.on("preSave",(function(){if(en)for(var e in F.minigames||(F.minigames={}),F.minigames.pantheon||(F.minigames.pantheon={slots:[]}),en.slotNames)-1!==en.slot[e]&&(F.minigames.pantheon.slots[e]="sync"),en.godsById[en.slot[e]]instanceof on&&(F.minigames.pantheon.slots[e]=en.slot[e],en.slot[e]=-1)})),fe.on("postSave",(function(){var e;if(en&&(null===(e=F.minigames)||void 0===e?void 0:e.pantheon))for(var n in en.slotNames){var t=F.minigames.pantheon.slots[n];void 0!==t&&"sync"!==t&&(en.slot[n]=t)}})),fe.on("reset",(function(){var e;(null===(e=F.minigames)||void 0===e?void 0:e.pantheon)&&(F.minigames.pantheon.slots=[])})),H.push((function(){var e;if(en&&(null===(e=F.minigames)||void 0===e?void 0:e.pantheon))for(var n in en.slotNames){var t=F.minigames.pantheon.slots[n];"sync"!==t&&en.godsById[t]instanceof on&&tn(en.godsById[t],parseInt(n))}}))),Ue.then((function(){var e=Game.Objects.Temple.minigame;ce(e);for(var n=0,t=[new le("customIcons",1,(function(){e.godTooltip=E(e.godTooltip,"'px;\"></div",'\'px;\' + (me.icon[2] ? "background-image: url(" + me.icon[2] + ");" : "") + \'"></div',"replace",{M:e}),e.slotTooltip=E(e.slotTooltip,"'px;\"></div",'\'px;\' + (me.icon[2] ? "background-image: url(" + me.icon[2] + ");" : "") + \'"></div',"replace",{M:e})}))];n<t.length;n++){t[n].runHook()}ce()}));var an=!window.__INTERNAL_CPPKIES_HOOKS__;if(an&&Game.UpdateMenu.toString().includes("Cppkies"))Game.Prompt('<h3>Hello!</h3>\n<div class="block">\nIt seems like you are trying to load Cppkies 0.3 or higher while having Cppkies 0.2 or lower already loaded.<br/>\nSadly, due to internal changes, Cppkies 0.3 mods are incompatible with Cppkies 0.2 mods. <br/>\n(The mod will still be launched, but it may or may not work correctly)<br/>\n<small>((If you are a mod author, please update your mods to use Cppkies 0.3 or higher.))</small><br/>\n</div>',[["Ok"+(Math.random()<.01?" boomer":""),"Game.ClosePrompt()"]]);else{for(var rn=0,sn=Game.ObjectsById;rn<sn.length;rn++){pe(sn[rn])}new Promise((function(e){if(window.__INTERNAL_CPPKIES_HOOKS__){if(window.__INTERNAL_CPPKIES_HOOKS__.hooksVersion>1)return fe.setForwardTarget(window.__INTERNAL_CPPKIES_HOOKS__.basegame),window.__INTERNAL_CPPKIES_HOOKS__.basegame;window.__INTERNAL_CPPKIES_HOOKS__.basegame.setForwardTarget(fe)}[new se("menu",1,(function(){Game.UpdateMenu=E(Game.UpdateMenu,null,'\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase "prefs":\n\t\t\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("optionsMenu")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase "stats":\n\t\t\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("statsMenu")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase "log":\n\t\t\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("logMenu")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("menu")\n\t\t\t\t\t',"after")})),new se("preSave",1,(function(){Game.WriteSave=E(Game.WriteSave,null,'\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("preSave")\n\t\t\t\t\t',"before")})),new se("postSave",1,(function(){Game.WriteSave=E(Game.WriteSave,"if (type==2 || type==3)",'\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.emit("postSave")\n\t\t\t\t\t',"before")})),new se("reset",1,(function(){Game.Reset=E(Game.Reset,null,'\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\t__INTERNAL_CPPKIES_HOOKS__.basegame.constEmit("reset", hard)\n\t\t\t\t\t',"before")})),new se("reincarnate",1,(function(){Game.registerHook("reincarnate",(function(){return fe.emit("reincarnate")}))})),new se("getIcon",1,(function(){Game.GetIcon=A(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];",'// Cppkies Injection\n\t\t\t\t\treturn __INTERNAL_CPPKIES_HOOKS__.basegame.emit("getIcon", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon',"replace"],["col=18;",'else if (type === "Mouse") col = 11;',"after"]])})),new se("buildStore",1,(function(){Game.BuildStore=E(Game.BuildStore,null,';\n__INTERNAL_CPPKIES_HOOKS__.basegame.emit("buildStore")',"after")})),new se("grandmaPic",1,(function(){Game.Objects.Grandma.art.pic=E(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'",'// Cppkies injection\n\t\t\t\t\tlist = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("grandmaPic", list)\n\t\t\t\t\t',"before")})),new se("cps",1,(function(){Game.CalculateGains=A(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;",'// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("rawCps", Game.cookiesPs);\n\t\t\t\t\tmult = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("rawCpsMult", mult);\n',"before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);",'// Cppkies injection\n\t\t\t\t\t\tmult = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("cpsMult", mult);\n',"before"]]),Game.registerHook("cps",(function(e){return fe.emit("cps",e)}))})),new se("cursorFingerMult",1,(function(){Game.Objects.Cursor.cps=E(Game.Objects.Cursor.cps,"var mult=1;",'// Cppkies injection\nadd = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("cursorFingerMult", add);\n',"before")})),new se("cpc",1,(function(){Game.mouseCps=A(Game.mouseCps,[["var num=0;",'// Cppkies injection\n\t\t\t\t\t\tadd = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("cursorFingerMult", add);\n',"before"],["var out",'// Cppkies injection\n\t\t\t\t\t\tadd = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("cpcAdd", add);\n',"before"]]),Game.registerHook("cookiesPerClick",(function(e){return fe.emit("cpc",e)}))})),new se("buildingCps",1,(function(){Game.CalculateGains=E(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;",'// Cppkies injection (internal, do not use)\nme.storedCps = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("buildingCps", { building: i, cps: me.storedCps }).cps;\n',"before")})),new se("logic",1,(function(){Game.registerHook("logic",(function(){return fe.emit("logic")}))})),new se("draw",1,(function(){Game.registerHook("draw",(function(){return fe.emit("draw")}))})),new se("check",1,(function(){Game.registerHook("check",(function(){return fe.emit("check")}))})),new se("ticker",1,(function(){Game.getNewTicker=E(Game.getNewTicker,"Game.TickerAge=Game.fps*10;",'// Cppkies injection\nlist = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("ticker", list);\n',"before")})),new se("specialPic",1,(function(){Game.DrawSpecial=E(Game.DrawSpecial,"if (hovered || selected)",'// Cppkies injection\nconst override = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("specialPic", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n',"before"),Game.ToggleSpecialMenu=E(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}",'// Cppkies injection\nconst override = __INTERNAL_CPPKIES_HOOKS__.basegame.emit("specialPic", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n',"after")})),new se("autoMoveDragonLevels",1,(function(){Game.ToggleSpecialMenu=A(Game.ToggleSpecialMenu,[[">=5",'>=Game.dragonLevels.findIndex(val => val.name === "Krumblor, cookie hatchling")',"replace"],[">=25",'>=Game.dragonLevels.findIndex(val => val.action === "Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>") + 1',"replace"]])})),new se("loaderFreedom",1,(function(){Game.Loader.Load=E(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=A(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]])})),new se("buildingAutoHook",1,(function(){Game.Object=E(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\n__INTERNAL_CPPKIES_HOOKS__.createBuildingHooks(this);\n","after")})),new se("milkMult",1,(function(){Game.CalculateGains=E(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\t__INTERNAL_CPPKIES_HOOKS__.hiddenMilkMult = milkMult;\n","before")}))].forEach((function(e){return e.runHook()})),window.__INTERNAL_CPPKIES_HOOKS__={basegame:fe,buildings:me,hiddenMilkMult:1,createBuildingHooks:pe,hooksVersion:1,injectedMinigames:new Set},e(fe)})).then((function(){if(xe(),an){Game.Notify("Cppkies loaded!","",[32,17],1.5);var n=document.createElement("div");n.textContent="Cppkies!";var t=document.querySelector("#topBar");t&&t.insertBefore(n,t.children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:ee,load:Z}),Game.Win("Third-party")}He.forEach((function(e){return e()})),an&&(window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach((function(e){return e()})),window.CPPKIES_ONLOAD=new Proxy([],{set:function(e,n,t){return"length"!==n&&t(),!0}})),null===e.defferResolve||void 0===e.defferResolve||e.defferResolve()}))}e.Achievement=Ce,e.BankAchievement=Oe,e.Building=Ae,e.Button=$e,e.CookieUpgrade=we,e.CpsAchievement=Ie,e.CursorUpgrade=ye,e.DEFAULT_CPS=function(e){return Game.GetTieredCpsMult(e)*Game.magicCpS(e.name)*e.baseCps},e.DEFAULT_ONBUY=function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&Game.Objects.Grandma.amount>0&&this.grandma&&Game.Unlock(this.grandma.name)},e.DragonAura=Ne,e.DragonAuraLevel=Me,e.DragonLevel=Te,e.GrandmaSynergy=he,e.HeavenlyUpgrade=oe,e.KittenUpgrade=_e,e.Level10Achievement=Pe,e.Milk=je,e.Mod=Be,e.MouseAchievement=Le,e.MouseUpgrade=Ge,e.MultiStateButton=Je,e.ProductionAchievement=Ee,e.Slider=ze,e.Spirit=on,e.SynergyUpgrade=ve,e.TieredAchievement=Se,e.TieredUpgrade=ae,e.ToggleBase=Xe,e.ToggleButton=Qe,e.Upgrade=ie,e.buildingHooks=me,e.ccButton=qe,e.ccHideableSection=Ve,e.ccSlider=We,e.customSpirits=[],e.deffer=Ue,e.friendlyAppendHtml=Fe,e.hooks=fe,e.icons=P,e.injectCode=E,e.injectCodes=A,e.isFortune=ne,e.minigamePromises=nn,e.miscValues=r,e.onLoad=He,e.save=F,e.setLoaded=xe,e.slotGod=tn,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
